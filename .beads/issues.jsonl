{"id":"gherkin-1m4","title":"Implement Gherkin lexer/tokenizer","description":"Build the lexer that tokenizes Gherkin source lines into a token stream.\n\n## Requirements\n- Consume Source line-by-line (Source is lines-based internally)\n- Recognize: Feature, Scenario, Scenario Outline, Background, Rule, Examples, Given/When/Then/And/But/*, comments (#), tags (@), doc string delimiters (\"\"\"/\\`\\`\\`), data table rows (|...|), language directive (# language:)\n- Track Location (line, column) for each token\n- Handle whitespace/indentation correctly (Gherkin is indentation-aware for readability but not semantically)\n- Produce tokens the parser can consume incrementally\n\n## Design Notes\n- Keep it simple: Gherkin is line-oriented, so a line-by-line tokenizer is natural\n- Consider an enum Token type with variants for each token kind\n- Keywords should be parameterized for i18n support from the start (or at least designed to allow it)","status":"closed","priority":1,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:08:13.537591915-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:27:59.193626313-06:00","closed_at":"2026-02-06T21:27:59.193626313-06:00","close_reason":"Implemented lexer with lexmatch-based classify_line, tokenize, and Lexer iterator. 43 tests all passing.","dependencies":[{"issue_id":"gherkin-1m4","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:39.052669296-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-3yh","title":"Parse Rule sections","description":"Add parser support for Rule (Gherkin 6+) grouping scenarios under business rules.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/rules.feature\n- Passes: BDD scenario \"Parse rules\"\n- Rule appears as FeatureChild::Rule in the AST\n- Rule can contain Background and Scenario children (RuleChild enum)\n- Tags on Rules are supported\n\n## Dependencies\n- Requires Background (gherkin-h8b) and tags (gherkin-orb) — Rules can have both","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:09:45.512778742-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:44:11.349561397-06:00","closed_at":"2026-02-06T21:44:11.349561397-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-3yh","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:40.47431654-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-3yh","depends_on_id":"gherkin-h8b","type":"blocks","created_at":"2026-02-06T20:24:59.049203834-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-3yh","depends_on_id":"gherkin-orb","type":"blocks","created_at":"2026-02-06T20:24:59.215319509-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-5lo","title":"Implement AST traversal (accept/fold)","description":"Implement the #declaration_only stubs for all ::accept() methods and GherkinDocument::fold().\n\n## Scope\n- GherkinDocument::accept — depth-first traversal calling visitor methods\n- Feature::accept, Rule::accept, Background::accept, Scenario::accept, Step::accept, Examples::accept, DataTable::accept, DocString::accept, Tag::accept, Comment::accept, TableRow::accept\n- GherkinDocument::fold — depth-first traversal threading accumulator with FoldAction flow control (Continue/SkipChildren/Stop)\n\n## Acceptance Criteria\n- All 12 accept() methods implemented\n- fold() respects Continue, SkipChildren, and Stop semantics\n- Traversal order: document → comments → feature → tags → children (depth-first)\n- Unit tests for visitor dispatch and fold accumulation\n\n## Dependencies\n- Requires minimal parser (gherkin-91v) so there are real ASTs to traverse","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:18:58.540288144-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:54:29.088146694-06:00","closed_at":"2026-02-06T21:54:29.088146694-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-5lo","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:40.833358201-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-5lo","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:59.562758826-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-8mg","title":"Implement parse_with_handler (SAX-style)","description":"Implement parse_with_handler(Source, \u0026GherkinHandler) — the push-based/SAX-style parsing API.\n\n## Requirements\n- Parser drives event dispatch: calls handler methods as it encounters structural elements\n- Follows nested lifecycle: DocumentStart → Feature → (Background|Scenario|Rule) → Steps → End events\n- No AST construction — events are dispatched directly from the parser/lexer\n- Should share tokenization with the tree-building parser\n\n## Acceptance Criteria\n- Handler receives correct events in document order\n- Start/end pairs are balanced\n- Event data (FeatureEvent, ScenarioEvent, etc.) is populated correctly\n- Unit tests using a recording handler that captures events\n\n## Dependencies\n- Requires lexer (gherkin-1m4) and core parser logic","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:18:58.723533152-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:55:50.70756614-06:00","closed_at":"2026-02-06T21:55:50.70756614-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-8mg","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:41.005756577-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-8mg","depends_on_id":"gherkin-1m4","type":"blocks","created_at":"2026-02-06T20:24:59.729397577-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-91v","title":"Parse minimal Feature + Scenario","description":"Implement core parser logic to handle the minimal Gherkin case: a Feature with one or more Scenarios containing Given/When/Then steps.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/minimal.feature\n- Passes: BDD scenario \"Parse a minimal feature file\" \n- Passes: BDD scenario \"Parse inline Gherkin text\"\n- parse(Source) returns GherkinDocument with Feature, Scenario(s), Step(s)\n- Location tracking is correct for all nodes\n- KeywordType classification works (Context/Action/Outcome/Conjunction/Unknown)\n\n## Fixture\n```gherkin\nFeature: Minimal\n  A feature with a single scenario.\n  Scenario: First scenario\n    Given a precondition\n    When an action is performed\n    Then an outcome is observed\n```\n\n## Dependencies\n- Requires lexer (gherkin-1m4)","status":"closed","priority":1,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:08:37.619857775-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:37:08.898325033-06:00","closed_at":"2026-02-06T21:37:08.898325033-06:00","close_reason":"Parser implemented with 23 tests. Handles Feature/Scenario/Steps with descriptions, location tracking, and clear error messages.","dependencies":[{"issue_id":"gherkin-91v","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:39.236415661-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-91v","depends_on_id":"gherkin-1m4","type":"blocks","created_at":"2026-02-06T20:24:57.814474773-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-a9e","title":"Implement CLI tool (JSON/JSONL output)","description":"Build the CLI wrapper that invokes the parser and outputs structured results.\n\n## Requirements (from AGENTS.md)\n- --json flag: emit parsed GherkinDocument as a single JSON object\n- --jsonl flag: emit as newline-delimited JSON (one event per line, uses GherkinHandler)\n- Read from file path argument or stdin\n- Uses TheWaWaR/clap for argument parsing\n- Proper exit codes (0 success, 1 parse error, 2 usage error)\n\n## Acceptance Criteria\n- CLI parses a .feature file and outputs valid JSON\n- CLI parses a .feature file and outputs valid JSONL\n- Error messages written to stderr\n- Integration tests exercising the CLI\n\n## Dependencies\n- Requires full parser and handler implementation\n- Requires JSON serialization for all AST types","status":"open","priority":3,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:18:59.097224055-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T20:18:59.097224055-06:00","dependencies":[{"issue_id":"gherkin-a9e","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:41.365294825-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-a9e","depends_on_id":"gherkin-jrl","type":"blocks","created_at":"2026-02-06T20:25:00.101504318-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-a9e","depends_on_id":"gherkin-8mg","type":"blocks","created_at":"2026-02-06T20:25:00.2706695-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-a9e","depends_on_id":"gherkin-5lo","type":"blocks","created_at":"2026-02-06T20:25:00.442545608-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-at5","title":"Parse Scenario Outline + Examples","description":"Add parser support for Scenario Outline with Examples tables.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/scenario_outline.feature\n- Passes: BDD scenario \"Parse a Scenario Outline\"\n- Scenario Outline recognized by keyword (examples array is non-empty)\n- Examples table_header and table_body parsed correctly\n- Placeholder syntax (\u003cname\u003e) preserved in step text (no expansion at parse time)\n\n## Dependencies\n- Requires data tables (gherkin-b3e) — Examples reuses table parsing","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:09:45.144456799-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:44:11.344028429-06:00","closed_at":"2026-02-06T21:44:11.344028429-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-at5","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:40.113339531-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-at5","depends_on_id":"gherkin-b3e","type":"blocks","created_at":"2026-02-06T20:24:58.887556938-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-b3e","title":"Parse data tables","description":"Add parser support for data tables as step arguments.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/data_tables.feature\n- Passes: BDD scenario \"Parse data tables\"\n- Rows and cells parsed correctly with Location tracking\n- Step.argument is set to StepArgument::DataTable\n- Cell escaping handled (pipe escaping with backslash)\n\n## Dependencies\n- Requires minimal parser (gherkin-91v)","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:08:54.790952928-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:42:04.121937686-06:00","closed_at":"2026-02-06T21:42:04.121937686-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-b3e","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:39.74296648-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-b3e","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:58.545781649-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-gc9","title":"Parse comments","description":"Add parser support for comment lines (lines starting with #).\n\n## Acceptance Criteria\n- Passes: tests/fixtures/comments.feature\n- Passes: BDD scenario \"Parse comments\"\n- Comments collected in GherkinDocument.comments array\n- Comment.location and Comment.text are correct\n- Comments do not interfere with other parsing (they are standalone, not attached to nodes)\n- Language directive (# language: xx) is NOT treated as a comment\n\n## Dependencies\n- Requires minimal parser (gherkin-91v)","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:09:45.325525755-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:42:04.103891117-06:00","closed_at":"2026-02-06T21:42:04.103891117-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-gc9","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:40.299389233-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-gc9","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:58.367071718-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-h8b","title":"Parse Background sections","description":"Add parser support for Background sections within a Feature.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/background.feature\n- Passes: BDD scenario \"Parse a feature with Background\"\n- Background steps are captured in the AST\n- Background appears as FeatureChild::Background\n\n## Fixture\nFeature with Background + two Scenarios sharing common setup steps.\n\n## Dependencies\n- Requires minimal parser (gherkin-91v)","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:08:54.415548461-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:42:04.117493292-06:00","closed_at":"2026-02-06T21:42:04.117493292-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-h8b","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:39.408955433-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-h8b","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:57.996295519-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-jrl","title":"Parse i18n (language directive)","description":"Add support for the # language: directive and internationalized keywords.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/i18n.feature (French)\n- Language directive (# language: fr) switches keyword recognition\n- Feature.language field is populated correctly\n- At minimum support: en, fr (expand later)\n- Keyword table maps language code to localized keywords\n\n## Design Notes\n- The official Gherkin i18n table (from cucumber/gherkin) covers 70+ languages\n- Start with a minimal table (en + fr) and make it extensible\n- Consider embedding the keyword table or loading it\n\n## Dependencies\n- Requires full parser (all Gherkin constructs) to be meaningful","status":"closed","priority":3,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:09:45.699096254-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:59:29.540837182-06:00","closed_at":"2026-02-06T21:59:29.540837182-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-jrl","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:40.653724723-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-jrl","depends_on_id":"gherkin-3yh","type":"blocks","created_at":"2026-02-06T20:24:59.924812242-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-kct","title":"Gherkin Parser Implementation","description":"Epic covering the full implementation of the MoonBit Gherkin parser, from lexer through AST construction, traversal APIs, CLI tool, and acceptance tests.\n\n## Current State\n- **Done**: API surface design — all types, traits, event structs, error types, Source abstraction, visitor/handler/fold patterns\n- **Done**: BDD acceptance specs (.feature files) and fixture files covering all Gherkin constructs\n- **Stub**: `parse()`, `parse_with_handler()`, all `::accept()` methods, `GherkinDocument::fold()`, `Source::from_bytes()`\n- **Not started**: Lexer, parser implementation, i18n, CLI, JSON/JSONL output\n\n## Approach\nIncremental TDD — implement the lexer first, then build the parser feature by feature (minimal → background → tags → data tables → doc strings → scenario outline → rules → comments → i18n). Each feature should pass its corresponding BDD acceptance test before moving on. Traversal APIs (accept/fold) and the handler-based parser come after the core parser. CLI is last.\n\n## Fixtures\n- minimal.feature, background.feature, scenario_outline.feature, tags.feature, data_tables.feature, doc_strings.feature, comments.feature, rules.feature, i18n.feature\n\n## Key Design Decisions\n- Functional design: ADTs, immutability, pattern matching, make invalid states unrepresentable\n- Source is opaque with lines-based internal representation\n- Three traversal APIs: Visitor (OOP pull), Handler (SAX push), Fold (functional accumulator)\n- Strict TDD: red-green-refactor","status":"open","priority":1,"issue_type":"epic","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:07:50.46465283-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T20:07:50.46465283-06:00"}
{"id":"gherkin-orb","title":"Parse tags (@smoke, @wip, etc.)","description":"Add parser support for tags on Features, Scenarios, Scenario Outlines, Examples, and Rules.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/tags.feature\n- Passes: BDD scenario \"Parse tags\"\n- Tags include the @ prefix in name field\n- Tags have correct Location\n- Tags attach to their parent node (Feature.tags, Scenario.tags, etc.)\n\n## Dependencies\n- Requires minimal parser (gherkin-91v)","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:08:54.598819814-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:42:04.11507335-06:00","closed_at":"2026-02-06T21:42:04.11507335-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-orb","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:39.578687982-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-orb","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:58.180279807-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-psy","title":"Parse doc strings","description":"Add parser support for doc strings (triple-quoted) as step arguments.\n\n## Acceptance Criteria\n- Passes: tests/fixtures/doc_strings.feature\n- Passes: BDD scenario \"Parse doc strings\"\n- Both triple-quote (\\\"\\\"\\\") and backtick (\\`\\`\\`) delimiters supported\n- Optional media type captured\n- Content indentation is trimmed relative to the delimiter\n- Step.argument is set to StepArgument::DocString\n\n## Dependencies\n- Requires minimal parser (gherkin-91v)","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:08:54.975978033-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:42:04.119755238-06:00","closed_at":"2026-02-06T21:42:04.119755238-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-psy","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:39.931710408-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-psy","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:58.722485335-06:00","created_by":"Damian Reeves"}]}
{"id":"gherkin-vv5","title":"Error handling and recovery","description":"Implement proper error handling for invalid Gherkin input.\n\n## Acceptance Criteria\n- Passes: BDD scenario \"Reject completely invalid input\"\n- Passes: BDD scenario \"Report missing Feature keyword\"\n- ParseError variants populated with meaningful messages and accurate Locations\n- UnexpectedToken, UnexpectedEof, InconsistentTableCells all used appropriately\n- CompositeError collects multiple errors when possible (don't stop at first error)\n\n## Dependencies\n- Requires minimal parser (gherkin-91v)","status":"closed","priority":2,"issue_type":"task","owner":"957246+DamianReeves@users.noreply.github.com","created_at":"2026-02-06T20:18:58.908070217-06:00","created_by":"Damian Reeves","updated_at":"2026-02-06T21:59:29.530002536-06:00","closed_at":"2026-02-06T21:59:29.530002536-06:00","close_reason":"Closed","dependencies":[{"issue_id":"gherkin-vv5","depends_on_id":"gherkin-kct","type":"parent","created_at":"2026-02-06T20:21:41.182940522-06:00","created_by":"Damian Reeves"},{"issue_id":"gherkin-vv5","depends_on_id":"gherkin-91v","type":"blocks","created_at":"2026-02-06T20:24:59.386518537-06:00","created_by":"Damian Reeves"}]}
