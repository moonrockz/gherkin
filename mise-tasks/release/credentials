#!/usr/bin/env bash
#MISE description="Set up mooncakes.io credentials from MOONCAKES_USER_TOKEN env var"
set -euo pipefail

if [ -z "${MOONCAKES_USER_TOKEN:-}" ]; then
  echo "Error: MOONCAKES_USER_TOKEN environment variable is not set" >&2
  echo "Set it from your mooncakes.io account token or GitHub Actions secret." >&2
  exit 1
fi

mkdir -p ~/.moon
cat > ~/.moon/credentials.json <<EOF
{"token": "${MOONCAKES_USER_TOKEN}"}
EOF

echo "Mooncakes credentials configured at ~/.moon/credentials.json"
